<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{% block title %}joshua@garden{% endblock %} ~ An Oliphant Never Forgets</title>
        <meta name="description" content="{% block description %}A digital garden - notes, learnings, and bookmarks from Joshua Oliphant{% endblock %}" />

        <!-- Terminal CSS -->
        <link href="/static/css/terminal.css" rel="stylesheet" />

        <!-- HTMX for dynamic loading -->
        <script src="https://unpkg.com/htmx.org@1.9.10"></script>

        <!-- Terminal JavaScript -->
        <script src="/static/js/terminal.js" defer></script>

        <!-- RSS Feed -->
        <link
            rel="alternate"
            type="application/rss+xml"
            title="RSS Feed"
            href="/feed.xml"
        />

        <!-- Favicon - terminal style -->
        <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>></text></svg>">
    </head>
    <body>
        <div class="crt-container">
            <div class="terminal">
                <!-- Terminal Header with ASCII Art -->
                <header class="terminal-header">
                    <pre class="ascii-logo">
     _       _ _        _                      _
  __| |_  __(_) |_ __ _| |   __ _  __ _ _ _ __| |___ _ __
 / _` \ \/ /| |  _/ _` | |  / _` |/ _` | '_/ _` / -_) '  \
 \__,_|\__/ |_|\__\__,_|_|  \__, |\__,_|_| \__,_\___|_||_|
                            |___/
                    </pre>
                    <div class="terminal-title">An Oliphant Never Forgets :: v1.0.0</div>
                </header>

                <!-- System Info Bar -->
                <div class="system-info">
                    <div>Last login: <span>{{ now().strftime('%a %b %d %H:%M:%S %Y') if now is defined else 'Welcome' }}</span></div>
                    <div>System: <span>digital-garden/fastapi</span></div>
                    <div>Type <span class="cmd-link" data-cmd="help">help</span> for commands</div>
                </div>

                <!-- Navigation Bar -->
                <nav class="nav-bar">
                    <a href="/" class="nav-item {% if request and request.url.path == '/' %}active{% endif %}">home</a>
                    <a href="/garden" class="nav-item {% if request and '/garden' in request.url.path %}active{% endif %}">notes</a>
                    <a href="/til" class="nav-item {% if request and '/til' in request.url.path %}active{% endif %}">til</a>
                    <a href="/bookmarks" class="nav-item {% if request and '/bookmarks' in request.url.path %}active{% endif %}">bookmarks</a>
                    <a href="/topics" class="nav-item {% if request and '/topics' in request.url.path or '/tags' in request.url.path %}active{% endif %}">tags</a>
                    <a href="/pages/about" class="nav-item {% if request and '/about' in request.url.path %}active{% endif %}">about</a>
                    <a href="/now" class="nav-item {% if request and '/now' in request.url.path %}active{% endif %}">now</a>
                </nav>

                <!-- Main Content Output Area -->
                <main id="terminal-output" class="output">
                    {% block content %}{% endblock %}
                </main>

                <!-- Command Input -->
                <div class="command-input-wrapper">
                    <div class="prompt">
                        <span class="prompt-user">visitor</span><span class="prompt-at">@</span><span class="prompt-host">garden</span><span class="prompt-separator">:</span><span class="prompt-path" id="prompt-path">{% block current_path %}/{% endblock %}</span><span class="prompt-symbol">$</span>
                    </div>
                    <input
                        type="text"
                        id="command-input"
                        class="command-input"
                        placeholder="type a command or click links above..."
                        autocomplete="off"
                        spellcheck="false"
                    />
                    <span class="cursor"></span>
                </div>

                <!-- Footer -->
                <footer class="terminal-footer">
                    <div>
                        <a href="/feed.xml">[RSS]</a> |
                        <a href="https://github.com/JoshuaOliphant" target="_blank" rel="noopener">[GitHub]</a> |
                        <span>&copy; {{ now().year if now is defined else '2024' }} Joshua Oliphant</span>
                    </div>
                </footer>
            </div>
        </div>

        <!-- HTMX Loading Indicator -->
        <div id="loading-indicator" class="loading-indicator">
            Processing<span class="loading"></span>
        </div>

        <script>
            // HTMX Loading states
            document.body.addEventListener('htmx:beforeRequest', function() {
                document.getElementById('loading-indicator').style.display = 'block';
            });
            document.body.addEventListener('htmx:afterRequest', function() {
                setTimeout(function() {
                    document.getElementById('loading-indicator').style.display = 'none';
                }, 200);
            });
        </script>
    </body>
</html>
