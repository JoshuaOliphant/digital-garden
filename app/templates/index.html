{% extends "base.html" %}

{% block title %}Digital Garden - Topographical Homepage{% endblock %}

{% block content %}
{% from 'macros/layout.html' import page_container, content_layout, prose_content %}

{% call page_container(title="Digital Garden", subtitle="A place for growing ideas") %}
  {% call content_layout() %}
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Featured Section -->
      {% if sections.featured %}
      <section class="mb-12">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-6 flex items-center">
          <span class="mr-2">ğŸŒŸ</span> Featured Content
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          {% for item in sections.featured %}
            {% include 'partials/featured_section.html' %}
          {% endfor %}
        </div>
      </section>
      {% endif %}

      <!-- Recently Tended Section -->
      {% if sections.recently_tended %}
      <section class="mb-12">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-6 flex items-center">
          <span class="mr-2">ğŸŒ¿</span> Recently Tended
        </h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
          {% for item in sections.recently_tended[:6] %}
            {% include 'partials/recently_tended_section.html' %}
          {% endfor %}
        </div>
        {% if sections.recently_tended|length > 6 %}
        <div class="mt-4 text-center">
          <button 
            hx-get="/api/recently-tended?page=2"
            hx-target="#more-recently-tended"
            hx-swap="outerHTML"
            class="px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors"
          >
            Load More
          </button>
          <div id="more-recently-tended"></div>
        </div>
        {% endif %}
      </section>
      {% endif %}

      <!-- Garden Beds (Topics) Section -->
      {% if sections.garden_beds %}
      <section class="mb-12">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-6 flex items-center">
          <span class="mr-2">ğŸ¡</span> Garden Beds
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
          {% for topic, items in sections.garden_beds.items() %}
            {% if items %}
            <div class="garden-bed">
              {% include 'partials/garden_bed_section.html' %}
            </div>
            {% endif %}
          {% endfor %}
        </div>
      </section>
      {% endif %}

      <!-- Call to Action -->
      <section class="mt-16 text-center">
        <div class="bg-gradient-to-r from-emerald-50 to-teal-50 dark:from-emerald-900/20 dark:to-teal-900/20 rounded-2xl p-8">
          <h3 class="text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4">
            Explore the Garden
          </h3>
          <div class="flex flex-wrap justify-center gap-4">
            <a href="/topics" 
               class="inline-flex items-center px-6 py-3 bg-white dark:bg-gray-800 text-emerald-600 dark:text-emerald-400 rounded-lg shadow-sm hover:shadow-md transition-all">
              <span class="mr-2">ğŸ—ºï¸</span> Browse Topics
            </a>
            <a href="/garden-paths" 
               class="inline-flex items-center px-6 py-3 bg-emerald-600 text-white rounded-lg shadow-sm hover:shadow-md hover:bg-emerald-700 transition-all">
              <span class="mr-2">ğŸš¶</span> Garden Paths
            </a>
            <a href="/wander" 
               class="inline-flex items-center px-6 py-3 bg-white dark:bg-gray-800 text-emerald-600 dark:text-emerald-400 rounded-lg shadow-sm hover:shadow-md transition-all">
              <span class="mr-2">ğŸ²</span> Wander
            </a>
          </div>
        </div>
      </section>
    </div>
  {% endcall %}
{% endcall %}
{% endblock %}

{% block scripts %}
<script>
  // Handle infinite scroll for garden beds if needed
  document.addEventListener('DOMContentLoaded', function() {
    // Add any topographical-specific JavaScript here
  });
</script>
{% endblock %}