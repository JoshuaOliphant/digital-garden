{% extends "base.html" %}

{% block title %}{{ metadata.title }}{% endblock %}
{% block current_path %}/{{ content_type }}/{{ metadata.slug or metadata.name }}{% endblock %}

{% block content %}
<!-- Command Output Header -->
<div class="output-block">
    <div class="output-line">
        <span class="prompt-symbol">$</span> <span style="color: var(--term-green);">cat ~/{{ content_type }}/{{ metadata.slug or metadata.name }}.md</span>
    </div>
</div>

<!-- Content Header -->
<div class="content-header">
    <h1>{{ metadata.title }}</h1>
    <div class="content-header-meta">
        <span style="color: var(--term-cyan);">{{ content_type }}</span>
        <span>{{ metadata.created }}</span>
        {% if metadata.growth_stage %}
        <span class="growth-stage growth-{{ metadata.growth_stage|lower }}">[{{ metadata.growth_stage|lower }}]</span>
        {% endif %}
        {% if metadata.updated and metadata.updated != metadata.created %}
        <span style="color: var(--term-gray);">updated: {{ metadata.updated }}</span>
        {% endif %}
    </div>
    {% if metadata.tags %}
    <div class="tags" style="margin-top: 0.5rem;">
        {% for tag in metadata.tags %}
        <a href="/tags/{{ tag }}" class="tag">{{ tag }}</a>
        {% endfor %}
    </div>
    {% endif %}
</div>

<!-- Main Content Body -->
<div class="content-body">
    {{ content | safe }}
</div>

<!-- Backlinks -->
{% if backlinks %}
<div class="output-block" style="margin-top: 2rem; border-top: 1px dashed var(--term-gray); padding-top: 1rem;">
    <div class="output-line" style="color: var(--term-amber);">## Backlinks</div>
    <div class="output-line" style="color: var(--term-gray);">Content that links to this page:</div>
    <ul style="margin-top: 0.5rem; list-style: none;">
        {% for backlink in backlinks %}
        <li style="padding: 0.25rem 0;">
            <span style="color: var(--term-gray);">→</span>
            <a href="/{{ backlink.content_type }}/{{ backlink.source_slug }}">{{ backlink.source_title }}</a>
        </li>
        {% endfor %}
    </ul>
</div>
{% endif %}

<!-- Related/Recent Content -->
{% if recent_how_tos or recent_notes %}
<div class="output-block" style="margin-top: 2rem; border-top: 1px dashed var(--term-gray); padding-top: 1rem;">
    <div class="output-line" style="color: var(--term-amber);">## See Also</div>

    {% if recent_how_tos and recent_how_tos.content %}
    <div style="margin-top: 0.5rem;">
        <div class="output-line" style="color: var(--term-gray);">Recent guides:</div>
        {% for how_to in recent_how_tos.content[:3] %}
        <div class="output-line">
            <span style="color: var(--term-gray);">→</span>
            <a href="/how_to/{{ how_to.name }}">{{ how_to.title }}</a>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if recent_notes and recent_notes.content %}
    <div style="margin-top: 0.5rem;">
        <div class="output-line" style="color: var(--term-gray);">Recent notes:</div>
        {% for note in recent_notes.content[:3] %}
        <div class="output-line">
            <span style="color: var(--term-gray);">→</span>
            <a href="/notes/{{ note.name }}">{{ note.title }}</a>
        </div>
        {% endfor %}
    </div>
    {% endif %}
</div>
{% endif %}

<!-- File Info -->
<div class="output-block" style="margin-top: 2rem; border-top: 1px dashed var(--term-gray); padding-top: 1rem; color: var(--term-gray); font-size: 0.85rem;">
    <div class="output-line">
        <span class="prompt-symbol">$</span> stat {{ metadata.slug or metadata.name }}.md
    </div>
    <div class="output-line">Created: {{ metadata.created }}</div>
    {% if metadata.updated and metadata.updated != metadata.created %}
    <div class="output-line">Modified: {{ metadata.updated }}</div>
    {% endif %}
</div>
{% endblock %}
