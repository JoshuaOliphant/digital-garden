{% macro serif_text(content, class='') -%}
  <span class="font-serif {{ class }}">{{ content }}</span>
{%- endmacro %}

{% macro sans_text(content, class='') -%}
  <span class="font-sans {{ class }}">{{ content }}</span>
{%- endmacro %}

{% macro drop_cap(content) -%}
  {% if content %}
    {% set first_char = content[0] %}
    {% set rest = content[1:] %}
    <p class="drop-cap">
      <span class="float-left text-6xl font-serif leading-none pr-2 pt-1 text-sage-700 dark:text-sage-300" aria-hidden="true">{{ first_char }}</span>{{ rest }}
    </p>
  {% endif %}
{%- endmacro %}

{% macro fluid_text(content, min_size='text-sm', max_size='text-lg', class='') -%}
  <span class="{{ min_size }} md:{{ max_size }} {{ class }}">{{ content }}</span>
{%- endmacro %}

{% macro heading_with_anchor(level, content, id='', class='') -%}
  {% set tag = 'h' ~ level %}
  {% set anchor_id = id or (content | lower | replace(' ', '-') | replace('[^a-z0-9-]', '')) %}
  {% set base_classes = {
    1: 'text-4xl md:text-5xl font-serif font-bold',
    2: 'text-3xl md:text-4xl font-serif font-semibold',
    3: 'text-2xl md:text-3xl font-serif font-semibold',
    4: 'text-xl md:text-2xl font-sans font-semibold',
    5: 'text-lg md:text-xl font-sans font-medium',
    6: 'text-base md:text-lg font-sans font-medium'
  } %}
  <{{ tag }} id="{{ anchor_id }}" class="{{ base_classes[level] }} {{ class }} text-gray-900 dark:text-gray-100 group">
    <a href="#{{ anchor_id }}" class="flex items-center gap-2 hover:text-sage-600 dark:hover:text-sage-400 transition-colors">
      {{ content }}
      <span class="opacity-0 group-hover:opacity-100 transition-opacity text-sage-500 dark:text-sage-400" aria-hidden="true">#</span>
    </a>
  </{{ tag }}>
{%- endmacro %}

{% macro quote_block(content, author='', cite='', class='') -%}
  <blockquote class="border-l-4 border-sage-300 dark:border-sage-600 pl-6 py-2 my-6 italic font-serif text-gray-700 dark:text-gray-300 {{ class }}">
    <p class="text-lg leading-relaxed">{{ content }}</p>
    {% if author or cite %}
    <footer class="mt-3 text-sm font-sans not-italic text-gray-600 dark:text-gray-400">
      {% if author %}
      <cite class="font-medium">
        {% if cite %}
        <a href="{{ cite }}" class="hover:text-sage-600 dark:hover:text-sage-400 transition-colors">{{ author }}</a>
        {% else %}
        {{ author }}
        {% endif %}
      </cite>
      {% endif %}
    </footer>
    {% endif %}
  </blockquote>
{%- endmacro %}

{% macro code_highlight(code, language='', class='') -%}
  <div class="code-highlight {{ class }}">
    <pre class="bg-gray-100 dark:bg-gray-800 rounded-lg p-4 overflow-x-auto">
      <code class="text-sm font-mono text-gray-800 dark:text-gray-200"{{ ' class="language-' + language + '"' if language else '' }}>{{ code }}</code>
    </pre>
  </div>
{%- endmacro %}